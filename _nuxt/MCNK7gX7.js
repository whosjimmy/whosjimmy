import{M as c,r as l,X as r,Y as i}from"./DsRIpS39.js";const w=()=>{const n=c().$auth,e=l({isSignedIn:!1,user:null,accessToken:null,loading:!1,error:null}),a=["https://www.googleapis.com/auth/youtube.readonly","https://www.googleapis.com/auth/youtube.force-ssl"];return{state:e,signInWithYouTube:async()=>{e.value.loading=!0,e.value.error=null;try{console.log("Starting YouTube sign-in...");const s=new r;a.forEach(u=>{s.addScope(u),console.log("Added scope:",u)}),s.setCustomParameters({prompt:"consent",access_type:"offline"}),console.log("Opening sign-in popup...");const o=await i(n,s);console.log("Sign-in successful:",o.user.email);const t=r.credentialFromResult(o);if(!t?.accessToken)throw new Error("Failed to obtain access token");return console.log("Access token obtained"),e.value.isSignedIn=!0,e.value.user=o.user,e.value.accessToken=t.accessToken,typeof window<"u"&&(localStorage.setItem("youtube_access_token",t.accessToken),localStorage.setItem("youtube_user_id",o.user.uid),console.log("Tokens stored in localStorage")),!0}catch(s){const o=s;return console.error("YouTube sign-in error:",o),console.error("Error code:",o.code),console.error("Error message:",o.message),e.value.error=o.message||"Failed to sign in with YouTube",!1}finally{e.value.loading=!1}},signOutYouTube:async()=>{e.value.isSignedIn=!1,e.value.user=null,e.value.accessToken=null,typeof window<"u"&&(localStorage.removeItem("youtube_access_token"),localStorage.removeItem("youtube_user_id"))},hasYouTubeAccess:()=>typeof window<"u"?!!localStorage.getItem("youtube_access_token"):!1,getAccessToken:()=>typeof window<"u"?localStorage.getItem("youtube_access_token"):null,initializeYouTubeAuth:()=>{if(typeof window<"u"){const s=localStorage.getItem("youtube_access_token"),o=localStorage.getItem("youtube_user_id");if(s&&o){e.value.isSignedIn=!0,e.value.accessToken=s;const t=n.currentUser;t&&t.uid===o&&(e.value.user=t)}}}}};export{w as u};
